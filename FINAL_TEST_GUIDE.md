# RAG 系統最終測試

## 📁 文件說明

- `final_system_test.js` - 最終的綜合測試文件（唯一測試文件）
- 所有其他測試文件已清理

## 🚀 使用方法

### 執行測試
```bash
node final_system_test.js
```

### 測試前檢查
1. 確保伺服器正在運行 (`npm start` 或 `node app.js`)
2. 確保資料庫連接正常
3. 確保 Google Cloud 配置正確

## 🧪 測試項目

1. **用戶註冊測試** - 測試新用戶註冊功能
2. **用戶登入測試** - 測試用戶登入功能  
3. **RAG 引擎創建測試** - 測試創建 RAG 引擎
4. **引擎列表測試** - 測試獲取引擎列表
5. **文件上傳測試** - 測試多文件上傳（FormData）
6. **文件列表測試** - 測試獲取文件列表
7. **RAG 查詢測試** - 測試基於文檔的查詢（核心功能）
8. **系統清理測試** - 測試清理功能

## 🔍 測試特點

- **嚴格驗證**: 每個 API 回應都經過完整驗證
- **錯誤處理**: 詳細的錯誤信息和失敗原因
- **文件上傳**: 使用正確的 FormData 格式
- **索引等待**: 35秒等待文件索引完成
- **競爭避免**: 文件上傳間有 3秒延遲
- **查詢驗證**: 驗證答案品質和關鍵詞匹配

## 📊 預期結果

```
🚀 開始執行 RAG 系統最終完整測試

🧪 執行測試: 用戶註冊測試
✅ 測試通過: 用戶註冊測試

🧪 執行測試: 用戶登入測試  
✅ 測試通過: 用戶登入測試

🧪 執行測試: RAG 引擎創建測試
✅ 測試通過: RAG 引擎創建測試

🧪 執行測試: 引擎列表測試
✅ 測試通過: 引擎列表測試

🧪 執行測試: 文件上傳測試
✅ 測試通過: 文件上傳測試

🧪 執行測試: 文件列表測試
✅ 測試通過: 文件列表測試

🧪 執行測試: RAG 查詢測試
✅ 測試通過: RAG 查詢測試

🧪 執行測試: 系統清理測試
✅ 測試通過: 系統清理測試

📊 測試結果統計
============================================================
✅ 通過: 8
❌ 失敗: 0  
📈 總計: 8
🎯 成功率: 100.0%
⏱️ 執行時間: XX 秒

🎉 所有測試都通過了！RAG 系統運行完全正常。
系統已準備好投入生產環境使用。
```

## ⚠️ 注意事項

1. **網路連接**: 需要穩定的網路連接到 Google Cloud
2. **資源配額**: 確保 Google Cloud 配額充足
3. **執行時間**: 完整測試需要約 1-2 分鐘
4. **資料隔離**: 每次測試使用唯一的用戶名和引擎名

## 🔧 調試

如果測試失敗：
1. 檢查伺服器日誌
2. 檢查 Google Cloud 配置
3. 檢查資料庫連接
4. 檢查網路連接

## 📝 測試數據

測試將上傳兩個文件：
- `document_france.txt` - 法國相關信息
- `document_nodejs.txt` - Node.js 技術信息

測試查詢包括：
- "法國的首都是什麼？"
- "Node.js 是什麼？" 
- "艾菲爾鐵塔在哪裡？"
- "npm 是什麼？"
